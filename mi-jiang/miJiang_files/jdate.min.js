(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.Jdate=t())})(this,function(){"use strict";function e(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===a&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}function t(e){if(i){if(e&&e.el){var t=this,a=t.$(e.el);if(a&&!a.bindJdate&&(a.bindJdate=1,t.extend(e),t.tap(a,function(){t.show()}),e.value)){"input"==a.nodeName.toLowerCase()?a.value=e.value:a.innerText=e.value;var n=e.value.replace(/-/g,"/").replace(/[^\d\/:\s]/g,""),o=new Date(n);o&&"Invalid Date"!=o?a.bindDate=o:console.error("Invalid Date："+n)}}}else console.error("jQuery is not defined")}var a="ul{margin:0;padding:0}li{list-style-type:none}.jdate-container{font-size:20px;color:#333;text-align:center}.jdate-container header{position:relative;line-height:60px;font-size:18px;border-bottom:1px solid #e0e0e0}.jdate-container .jdate-mask{position:fixed;width:100%;height:100%;top:0;left:0;background:#000;opacity:.4;z-index:999}.jdate-container .jdate-panel{position:fixed;bottom:0;left:0;width:100%;height:273px;z-index:1000;background:#fff;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-delay:0s;animation-delay:0s;-webkit-animation-iteration-count:1;animation-iteration-count:1}.jdate-container .jdate-btn{position:absolute;left:0;top:0;height:100%;padding:0 15px;color:#999;font-size:16px;cursor:pointer;-webkit-tap-highlight-color:transparent}.jdate-container .jdate-confirm{left:auto;right:0;color:#DF1106}.jdate-container .jdate-content{position:relative;top:20px}.jdate-container .jdate-wrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.jdate-container .jdate-wrapper>div{position:relative;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;height:173px;line-height:36px;overflow:hidden;-webkit-flex-basis:-8e;-ms-flex-preferred-size:-8e;flex-basis:-8e;width:1%}.jdate-container .jdate-wrapper ul{position:absolute;left:0;top:0;width:100%;margin-top:68px}.jdate-container .jdate-wrapper li{height:36px}.jdate-container .jdate-dim{position:absolute;left:0;top:0;width:100%;height:68px;background:-webkit-gradient(linear,left bottom,left top,from(hsla(0,0%,100%,.4)),to(hsla(0,0%,100%,.8)));background:-webkit-linear-gradient(bottom,hsla(0,0%,100%,.4),hsla(0,0%,100%,.8));background:-o-linear-gradient(bottom,hsla(0,0%,100%,.4),hsla(0,0%,100%,.8));background:-webkit-gradient(linear, left bottom, left top, from(hsla(0, 0%, 100%, 0.4)), to(hsla(0, 0%, 100%, 0.8)));background:-webkit-linear-gradient(bottom, hsla(0, 0%, 100%, 0.4), hsla(0, 0%, 100%, 0.8));background:-o-linear-gradient(bottom, hsla(0, 0%, 100%, 0.4), hsla(0, 0%, 100%, 0.8));background:linear-gradient(0deg,hsla(0,0%,100%,.4),hsla(0,0%,100%,.8));pointer-events:none;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:10}.jdate-container .mask-top{border-bottom:1px solid #ebebeb}.jdate-container .mask-bottom{top:auto;bottom:1px;border-top:1px solid #ebebeb}.jdate-container .fadeIn{-webkit-animation-name:fadeIn;animation-name:fadeIn}.jdate-container .fadeOut{-webkit-animation-name:fadeOut;animation-name:fadeOut}@-webkit-keyframes fadeIn{0%{bottom:-273px}to{bottom:0}}@keyframes fadeIn{0%{bottom:-273px}to{bottom:0}}@-webkit-keyframes fadeOut{0%{bottom:0}to{bottom:-273px;display:none}}@keyframes fadeOut{0%{bottom:0}to{bottom:-273px;display:none}}@media screen and (max-width:414px){.jdate-container{font-size:18px}}@media screen and (max-width:320px){.jdate-container{font-size:15px}}";e(a);var n="2.0.0",i=void 0!==i?i:"undefined"!=typeof jQuery?jQuery:null,o=36;return t.usejQuery=function(e){i=e},t.prototype={constructor:t,baseData:function(){return{domId:{YYYY:"jdate-year",MM:"jdate-month",DD:"jdate-day",hh:"jdate-hour",mm:"jdate-min",ss:"jdate-sec"},opts:{el:"",format:"YYYY-MM-DD",beginYear:2e3,endYear:2100,init:null,moveEnd:null,confirm:null,cancel:null,minStep:1,trigger:"tap",lang:{title:"选择日期",cancel:"取消",confirm:"确定",year:"年",month:"月",day:"日",hour:"时",min:"分",sec:"秒"}}}},extend:function(e){var t=this,a=t.baseData().opts;for(var n in a)if(a[n]&&"[object Object]"==Object.prototype.toString.call(a[n]))for(var i in e[n])a[n][i]=null==e[n][i]?a[n][i]:e[n][i];else a[n]=e[n]||a[n];t.config=a},createUI:function(){for(var e=this,t=e.baseData(),a=e.config,n=t.domId,o=a.format.split(/-|\/|\s|:/g),r=o.length,s="",d=e.$(a.el).bindDate||new Date,l="",c=a.lang,p=0;p<r;p++){var f=o[p];if(s+='<div id="'+n[f]+'"><ul>',"YYYY"==f)for(var u=a.beginYear;u<=a.endYear;u++)l=u==d.getFullYear()?"active":"",s+='<li class="'+l+'">'+u+c.year+"</li>";else if("MM"==f)for(var m=1;m<=12;m++)l=m==d.getMonth()+1?"active":"",s+='<li class="'+l+'">'+(m<10?"0"+m:m)+c.month+"</li>";else if("DD"==f)for(var h=e.bissextile(d.getFullYear(),d.getMonth()+1),v=1;v<=h;v++)l=v==d.getDate()?"active":"",s+='<li class="'+l+'">'+(v<10?"0"+v:v)+c.day+"</li>";else if("hh"==f)for(var b=0;b<=23;b++)l=b==d.getHours()?"active":"",s+='<li class="'+l+'">'+(b<10?"0"+b:b)+c.hour+"</li>";else if("mm"==f)for(var g=0;g<=59;g+=a.minStep)l=g==d.getMinutes()?"active":"",s+='<li class="'+l+'">'+(g<10?"0"+g:g)+c.min+"</li>";else if("ss"==f)for(var x=0;x<=59;x++)l=x==d.getSeconds()?"active":"",s+='<li class="'+l+'">'+(x<10?"0"+x:x)+c.sec+"</li>";s+="</ul></div>"}var j='<div class="jdate-mask"></div>\n            <div class="jdate-panel fadeIn">\n                <header>\n                    <span class="jdate-btn jdate-cancel">'+c.cancel+"</span>\n                    "+c.title+'\n                    <span class="jdate-btn jdate-confirm">'+c.confirm+'</span>\n                </header>\n                <section class="jdate-content">\n                    <div class="jdate-dim mask-top"></div>\n                    <div class="jdate-dim mask-bottom"></div>\n                    <div class="jdate-wrapper">\n                        '+s+"\n                    </div>\n                </section>\n            </div>",y=document.createElement("div");y.className="jdate-container",y.innerHTML=j,document.body.appendChild(y),e.scroll={};for(var w=0;w<r;w++){var D=n[o[w]];e.scroll[o[w]]=D,e.slide(i("#"+D+">ul"))}e.scroll.mm&&1!=a.minStep&&i("#"+e.scroll.mm+" li").eq(Math.round(d.getMinutes()/a.minStep)).addClass("active"),i(".jdate-container ul").each(function(){var e=i(this),t=e.find(".active"),a=-t.position().top;e.animate({top:a},0)})},eventType:function(){var e="ontouchend"in document;return{isTouch:e,tstart:e?"touchstart":"mousedown",tmove:e?"touchmove":"mousemove",tend:e?"touchend":"mouseup",tcancel:e?"touchcancel":"mouseleave"}},slide:function(e){function t(e){var t=e.position().top;e.css("top",Math.round(t/o)*o+"px"),t=Math.round(Math.abs(i(e).position().top));var s=e.children("li").get(t/o);if(i(s).addClass("active").siblings().removeClass("active"),-1!=[n.YYYY,n.MM].indexOf(e.parent().attr("id"))&&a.scroll.DD){var d=i("#"+n.YYYY+" .active").text().replace(/\D/g,""),l=i("#"+n.MM+" .active").text().replace(/\D/g,"");if(!d||!l)return;var c=a.bissextile(d,l);if(c!=i("#"+n.DD+" li").length){var p=i("#"+n.DD+" .active"),f=p.text().replace(/\D/g,""),u="",m=i("#"+n.DD+" ul");f>c&&(f=c);for(var h=1;h<=c;h++)u+="<li "+(f==h?'class="active"':"")+">"+(h<10?"0"+h:h)+r.day+"</li>";i("#"+n.DD+" ul").html(u),Math.abs(m.position().top)>m.height()-o&&m.css("top","-"+(m.height()-o)+"px")}}a.config.moveEnd&&a.config.moveEnd.call(a)}var a=this,n=a.baseData().domId,r=a.config.lang,s=void 0,d=void 0,l=!1,c=a.eventType();e.bind(c.tstart,function(e){e.stopPropagation(),e.preventDefault(),e=e.originalEvent,s=e.pageY||e.touches[0].pageY,c.isTouch||(l=!0)}),e.bind(c.tmove,function(e){var t=i(this);if(e.stopPropagation(),e.preventDefault(),e=e.originalEvent,!c.isTouch&&!l)return!1;d=e.pageY||e.touches[0].pageY,t.css("top",t.position().top+(d-s)+"px"),s=d,t.position().top>0&&t.css("top","0"),t.position().top<-(t.height()-o)&&t.css("top","-"+(t.height()-o)+"px")}),e.bind(c.tend,function(e){var a=i(this);e.stopPropagation(),e.preventDefault(),e=e.originalEvent,l=!1,t(a)}),e.bind(c.tcancel,function(e){var a=i(this);e.stopPropagation(),e.preventDefault(),e=e.originalEvent,l=!1,t(a)})},$:function(e,t){return"string"!=typeof e&&e.nodeType?e:t?document.querySelectorAll(e):document.querySelector(e)},tap:function(e,t){var a=this,n="ontouchstart"in window;if(n&&"tap"==a.config.trigger){var i={};e.addEventListener("touchstart",function(e){var t=e.touches[0];i.startX=t.pageX,i.startY=t.pageY,i.sTime=+new Date}),e.addEventListener("touchend",function(e){var a=e.changedTouches[0];i.endX=a.pageX,i.endY=a.pageY,+new Date-i.sTime<300&&Math.abs(i.endX-i.startX)+Math.abs(i.endY-i.startY)<20&&(e.preventDefault(),t.call(this,e)),i={}})}else e.addEventListener("click",function(e){t.call(this,e)})},show:function(){var e=this,t=e.config,a=e.$(t.el);a.bindJdate&&("input"==a.nodeName.toLowerCase()&&a.blur(),e.$(".jdate-container")||t.init&&!1===t.init.call(e)||(e.createUI(),e.event()))},hide:function(e){var t=this,a=t.$(".jdate-panel.fadeIn");a&&(a.className="jdate-panel fadeOut",t.destroy(e))},event:function(){var e=this,t=e.$(".jdate-mask"),a=e.$(".jdate-cancel"),n=e.$(".jdate-confirm");e.tap(t,function(){e.hide(1)}),e.tap(a,function(){e.hide(1)}),e.tap(n,function(){var t=e.config,a=e.$(t.el),n=t.format,o=new Date;for(var r in e.scroll){var s=i("#"+e.scroll[r]+" .active").text().replace(/\D/g,"");n=n.replace(r,s),"YYYY"==r?o.setFullYear(s):"MM"==r?o.setMonth(s-1):"DD"==r?o.setDate(s):"hh"==r?o.setHours(s):"mm"==r?o.setMinutes(s):"ss"==r&&o.setSeconds(s)}if(t.confirm){var d=t.confirm.call(e,n);if(!1===d)return!1;d&&(n=d)}"input"==a.nodeName.toLowerCase()?a.value=n:a.innerText=n,e.hide(),a.bindDate=o})},bissextile:function(e,t){var a=void 0;return 1==t||3==t||5==t||7==t||8==t||10==t||12==t?a=31:4==t||6==t||11==t||9==t?a=30:2==t&&(a=e%4!=0||e%100==0&&e%400!=0?28:29),a},destroy:function(e){var t=this,a=t.config;e&&a.cancel&&a.cancel.call(t),setTimeout(function(){var e=t.$(".jdate-container");document.body.removeChild(e)},300)}},t.version=n,t});